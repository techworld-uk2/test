Sub ReorderColumnsBasedOnValues()
    Dim sourceWB As Workbook
    Dim targetWB As Workbook
    Dim sourceWS As Worksheet
    Dim targetWS As Worksheet
    Dim sourceColumn As Range
    Dim targetColumn As Range
    Dim sourceColumnValue As Variant
    Dim targetColumnValue As Variant
    Dim targetColumnPosition As Long
    
    ' Update these file paths with the actual file paths for your source and target workbooks
    Set sourceWB = Workbooks.Open("C:\path\to\source_workbook.xlsx")
    Set targetWB = Workbooks.Open("C:\path\to\target_workbook.xlsx")
    
    ' Replace "Sheet1" with the actual name of the worksheet containing the source column values
    Set sourceWS = sourceWB.Worksheets("Sheet1")
    ' Replace "Sheet1" with the actual name of the worksheet where the columns need to be reordered
    Set targetWS = targetWB.Worksheets("Sheet1")
    
    ' Loop through the columns in the source workbook
    For Each sourceColumn In sourceWS.UsedRange.Columns
        ' Assuming the values are in the first row of the source column (change 1 to a different row number if needed)
        sourceColumnValue = sourceColumn.Cells(1).Value
        
        ' Find the corresponding column in the target workbook based on the value
        Set targetColumn = targetWS.Rows(1).Find(What:=sourceColumnValue, LookIn:=xlValues, LookAt:=xlWhole)
        
        ' If the target column is found, get its position and move it to the same position as the source column
        If Not targetColumn Is Nothing Then
            targetColumnPosition = targetColumn.Column
            targetColumn.EntireColumn.Cut
            targetWS.Columns(sourceColumn.Column).Insert Shift:=xlToRight
            Application.CutCopyMode = False
        Else
            ' Handle the case when the source column value is not found in the target workbook (optional)
            ' You may choose to skip the column or handle it differently based on your requirements.
            MsgBox "Column with value '" & sourceColumnValue & "' not found in the target workbook."
        End If
    Next sourceColumn
    
    ' Save and close both workbooks
    sourceWB.Close SaveChanges:=False
    targetWB.Close SaveChanges:=True
End Sub
