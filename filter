import pandas as pd

# Load the Excel file and specify the sheet name
file_path = r'C:\Users\c-abhimanyue\Downloads\KPMG-CRISIL-Master-Tracker.xlsx'
df = pd.read_excel(file_path, sheet_name='Web_Application')

# Print the column names to check for discrepancies
print("Column names in the file:", df.columns)

# Strip whitespace from column names
df.columns = df.columns.str.strip()

# Prompt the user to enter the Application name to filter
application_name = input("Enter the Application name to filter: ")

# Check if 'Application name' is present in the DataFrame
if 'Application name' in df.columns:
    # Filter the DataFrame based on case-insensitive matching of the Application name
    filtered_df = df[df['Application name'].str.contains(application_name, case=False, na=False)]

    # Display the contents of columns 'Month' and 'Assignee' in a table format
    if 'Month' in df.columns and 'Assignee' in df.columns:
        if not filtered_df.empty:
            result = filtered_df[['Month', 'Assignee']]
            print(result)
        else:
            print("No matching records found for the application name.")
    else:
        print("Columns 'Month' and 'Assignee' are not found in the sheet. Available columns are:", df.columns)
else:
    print("'Application name' column is not found in the sheet. Available columns are:", df.columns)
